# frozen_string_literal: true
#
# GENERATED FILE. DO NOT EDIT DIRECTLY.

<%

require 'json'
messages = JSON.parse(File.read(src)).sort_by { |m| m["message_code"] }

-%>
module Sip2
  MESSAGES = [
% messages.each do |m|
    {
      code: "<%= m["message_code"] %>",
      name: "<%= m["message_name"]["text"] %>",
      symbol: <%= m["message_name"]["code"].to_sym.inspect %>,
% if m["fields"]["ordered"].any?
      ordered_fields: %i[
        <%= m["fields"]["ordered"].join("\n        ") %>
      ],
% else
      ordered_fields: [],
% end
% if m["fields"]["delimited"].any?
      required_delimited_fields: %i[
        <%= m["fields"]["delimited"].join("\n        ") %>
      ],
      # TODO: Move any optional fields for <%= m["message_name"]["text"] %> here
% else
      required_delimited_fields: [],
% end
      optional_delimited_fields: [],
    },
% end
  ]

  MESSAGES_BY_CODE = MESSAGES
    .group_by { |m| m[:code] }
    .map { |k,v| [k,v.first] }
    .to_h
end
